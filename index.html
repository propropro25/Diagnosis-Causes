<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Diseases with Unknown Cause</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/baguettebox.js@1.11.1/dist/baguetteBox.min.css">
<style>
  :root{color-scheme:dark}
  body{margin:0;background:#0b0b0b;color:#f0f0f0;font:14px/1.45 system-ui,-apple-system,Segoe UI,Roboto,sans-serif}
  #gh-gallery{max-width:1100px;margin:28px auto;padding:0 16px}
  #hero{position:relative;background:#000;border-radius:12px;overflow:hidden}
  #hero img{display:block;width:100%;height:58vh;max-height:720px;object-fit:contain;background:#000}
  #hero .caption{position:absolute;left:12px;bottom:10px;font-size:12px;opacity:.7}
  #thumbs{margin-top:10px;display:flex;gap:8px;overflow-x:auto;padding-bottom:6px;scrollbar-width:thin}
  #thumbs a{display:block;flex:0 0 auto;border-radius:10px;overflow:hidden;outline:0}
  #thumbs img{display:block;height:90px;width:auto;object-fit:cover;background:#000;transition:opacity .15s}
  #thumbs a[aria-current="true"] img{outline:2px solid #5aa2ff;opacity:1}
  #thumbs img{opacity:.85}
  #thumbs a:hover img{opacity:1}
  #status{margin-top:8px;opacity:.6}
  .sr{position:absolute;left:-9999px}
  .hide{display:none}
  /* optional max width for Ghost embed */
  @media (max-width:640px){#hero img{height:55vh} #thumbs img{height:74px}}
</style>
</head>
<body>
<div id="gh-gallery" aria-live="polite">
  <h1 style="margin:0 0 14px;font-size:18px;font-weight:600">Gallery</h1>
  <div id="hero" class="hide">
    <a id="heroLink" href="#" data-caption="">
      <img id="heroImg" src="" alt=""/>
    </a>
    <div id="heroCap" class="caption"></div>
  </div>
  <div id="thumbs" class="tz-gallery hide" role="listbox" aria-label="Thumbnails"></div>
  <div id="status"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/baguettebox.js@1.11.1/dist/baguetteBox.min.js"></script>
<script>
const CFG={owner:"propropro25",repo:"Diagnosis-Causes",path:"",branch:"main",
           exts:[".png",".jpg",".jpeg",".webp",".gif"],sort:"name-asc"};
const S=t=>document.getElementById("status").textContent=t||"";
let imgs=[],idx=0;

async function list(){
  const api=`https://api.github.com/repos/${CFG.owner}/${CFG.repo}/contents/${encodeURIComponent(CFG.path)}?ref=${CFG.branch}`;
  const r=await fetch(api); if(!r.ok) throw new Error("GitHub API "+r.status);
  const items=await r.json();
  return items.filter(x=>x.type==="file" && CFG.exts.some(e=>x.name.toLowerCase().endsWith(e)))
              .sort((a,b)=>a.name.localeCompare(b.name,undefined,{numeric:true}))
              .map(x=>({src:x.download_url,alt:x.name}));
}

function render(){
  const hero=document.getElementById('hero');
  const heroImg=document.getElementById('heroImg');
  const heroLink=document.getElementById('heroLink');
  const heroCap=document.getElementById('heroCap');
  const strip=document.getElementById('thumbs');

  // hero
  const cur=imgs[idx];
  heroImg.src=cur.src; heroImg.alt=cur.alt;
  heroLink.href=cur.src; heroLink.dataset.caption=cur.alt;
  heroCap.textContent=cur.alt;
  hero.classList.remove('hide');

  // thumbs
  strip.innerHTML = imgs.map((im,i)=>
    `<a href="${im.src}" data-caption="${im.alt}" role="option" aria-selected="${i===idx}" aria-current="${i===idx?'true':'false'}">
       <img src="${im.src}" alt="${im.alt}" loading="lazy" decoding="async">
     </a>`).join('');
  strip.classList.remove('hide');

  // thumb click -> swap hero
  [...strip.querySelectorAll('a')].forEach((a,i)=>{
    a.addEventListener('click',ev=>{
      ev.preventDefault();
      idx=i; render();
      // open lightbox if user clicked a selected thumb again (optional)
    }, {passive:false});
  });

  // lightbox on hero click; also allow arrow navigation inside lightbox
  baguetteBox.run('#gh-gallery .tz-gallery, #hero', {noScrollbars:true, async:true});

  S(`${imgs.length} image(s)`);
}

(async()=>{
  try{
    S("Loadingâ€¦");
    imgs = await list();
    if(!imgs.length){S("No images found in repo path."); return;}
    render();
    S("");
  }catch(e){console.error(e); S("Failed to load. Ensure repo is public and path is correct.");}
})();
</script>
</body>
</html>
